SELECT DISTINCT
    vh.VERIFICATION_NUMBER,
    vs.STATE, 
    vs.LOAD_DATE 
FROM PAS_IMPL.VERIFICATION_HUB as vh
LEFT JOIN PAS_IMPL.POLICY_VERIFICATION_LINK as pvl on pvl.VERIFICATION_HKEY = vh.VERIFICATION_HKEY
LEFT JOIN PAS_IMPL.POLICY_HUB as ph on ph.POLICY_HKEY = pvl.POLICY_HKEY
LEFT JOIN PAS_IMPL.POLICY_SAT_LATEST as psl on psl.POLICY_HKEY = pvl.POLICY_HKEY
LEFT JOIN PAS_IMPL.VERIFICATION_SAT_LATEST as vs on vs.VERIFICATION_HKEY = vh.VERIFICATION_HKEY 
WHERE 1 = 1
{{#if parameters.contractNumber}}
AND ph.CONTRACT_NUMBER = @contractNumber
{{/if}}
{{#if parameters.partyCode}}
AND psl.HOLDER_CODE = @partyCode
{{/if}}

