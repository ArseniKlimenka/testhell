SELECT
	c.ID,
	c.PRODUCT_GROUP_CODE,
	c.PRODUCT_CODE,
	c.RISK_GROUP_CODE,
	crg.MAX_RISK_COUNT,
	crg.MRC_ALGORITHM,
	crg.MRC_ALGORITHM_PRODUCT_CODES,
	crgR.RISK_CODE,
	rpr.RISK_PERSON,
	cla.CODE AGE_CODE,
	cla.AGE_FROM,
	cla.AGE_TO,
	clam.CODE AMOUNT_CODE,
	clam.AMOUNT_FROM,
	clam.AMOUNT_TO,
	c.TRIGGER_CODE,
	ct.DESCRIPTION TRIGGER_DESCRIPTION,
	crg.CODE_DESCRIPTION GROUP_CODE_DESCRIPTION,
	clap.CODE ACTIVE_CODE,
	clap.ACTIVE_FROM,
	clap.ACTIVE_TO
FROM PAS_IMPL.CUMULATION c
LEFT JOIN PAS_IMPL.CUMULATION_RISK_GROUP_RELATION crgR ON crgR.GROUP_CODE = c.RISK_GROUP_CODE
LEFT JOIN PAS_IMPL.CUMULATION_RISK_GROUP crg ON crg.CODE = crgR.GROUP_CODE
LEFT JOIN PAS_IMPL.CUMULATION_LIMIT_AGE cla ON cla.CODE = c.LIMIT_AGE_CODE
LEFT JOIN PAS_IMPL.CUMULATION_LIMIT_AMOUNT clam ON clam.CODE = c.LIMIT_AMOUNT_CODE
LEFT JOIN PAS_IMPL.CUMULATION_TRIGGER ct ON ct.CODE = c.TRIGGER_CODE
LEFT JOIN PAS_IMPL.CUMULATION_PRODUCT_GROUP_RELATION cpgR ON cpgR.PRODUCT_GROUP_CODE = c.RISK_GROUP_CODE
LEFT JOIN PAS_IMPL.CUMULATION_LIMIT_ACTIVE_PERIOD clap ON clap.CODE = c.ACTIVE_PERIOD_CODE
LEFT JOIN BFX_IMPL.RISK_PRODUCT_RELATION rpr ON rpr.RISK_CODE = crgR.RISK_CODE
WHERE 1=1
AND c.PRODUCT_GROUP_CODE = @cumulationProductGroup
AND c.PRODUCT_CODE = @productCode
AND @currentDate >= clap.ACTIVE_FROM AND @currentDate <= clap.ACTIVE_TO