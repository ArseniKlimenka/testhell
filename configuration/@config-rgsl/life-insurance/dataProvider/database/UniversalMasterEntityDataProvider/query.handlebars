SELECT
	 ph.CONTRACT_NUMBER
	,ume.UNIVERSAL_MASTER_ENTITY_ID
    ,ume.UNIVERSAL_MASTER_ENTITY_CODE
    ,ume.BODY
    ,ume.COMMON_BODY
    ,ume.EXTERNAL_DATA
    ,ume.PUBLISHED_ARTIFACT_ID
    ,ume.SYS_CREATED_ON
    ,ume.SYS_CREATED_BY_ID
    ,ume.SYS_UPDATED_ON
    ,ume.SYS_UPDATED_BY_ID
    ,ume.SYS_CLIENT_ID
    ,ume.SYS_VERSION
    ,ume.SYS_SOURCE_SYSTEM
FROM PAS_IMPL.POLICY_HUB ph
LEFT JOIN PAS_IMPL.POLICY_INVESTMENT_SAT_LATEST pInvSL ON pInvSL.POLICY_INVESTMENT_HKEY = ph.POLICY_HKEY
LEFT JOIN BFX_IMPL.ADDITIONAL_PARAMETERS_POLICY_LINK appl ON appl.POLICY_HKEY = ph.POLICY_HKEY
LEFT JOIN BFX_IMPL.ADDITIONAL_PARAMETERS_HUB aph ON aph.ADDITIONAL_PARAMETERS_HKEY = appl.ADDITIONAL_PARAMETERS_HKEY
LEFT JOIN BFX_IMPL.ADDITIONAL_PARAMETERS_SAT_LATEST apsl ON apsl.ADDITIONAL_PARAMETERS_HKEY = aph.ADDITIONAL_PARAMETERS_HKEY
LEFT JOIN BFX.UNIVERSAL_MASTER_ENTITY ume ON ume.UNIVERSAL_MASTER_ENTITY_CODE = aph.DOCUMENT_NUMBER
WHERE 1=1
{{#if parameters.contractNumber}}
  AND ph.CONTRACT_NUMBER = @contractNumber
{{/if}}
{{#if parameters.universalMasterEntityCode}}
  AND UNIVERSAL_MASTER_ENTITY_CODE = @universalMasterEntityCode
{{/if}}