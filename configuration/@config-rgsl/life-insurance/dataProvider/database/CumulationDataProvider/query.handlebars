SELECT DISTINCT
	csl.RISK_GROUP_CODE,
	crg.CODE_DESCRIPTION RISK_GROUP_CODE_DESCRIPTION,
	cdsl.DOCUMENT_NUMBER,
	ps.CODE_NAME DOCUMENT_STATE_CODE,
	crsl.RISK_CODE,
	r.SHORT_DESCRIPTION,
	cdsl.CURRENCY_CODE,
	crsl.RISK_INSURED_SUM,
	pa.CODE_NAME DOCUMENT_CONF_CODE,
	csl.CUMULATION_INSURED_SUM,
	cla.AMOUNT_FROM,
	cla.AMOUNT_TO,
	cla.AMOUNT_DESCRIPTION,
	csl.IS_LIMIT_EXCEEDED,
	ct.DESCRIPTION TRIGGER_CODE,
	csl.PARTY_CODE,
	csl.PARTY_TYPE,
	csl.PARTY_AGE,
	ptyS.FULL_NAME PARTY_FULL_NAME,
	cu.ID CUMULATION_RULE_ID
FROM PAS_IMPL.CUMULATION_HUB ch
JOIN PAS_IMPL.CUMULATION_SAT_LATEST csl ON csl.CUMULATION_HKEY = ch.CUMULATION_HKEY
JOIN PTY_IMPL.PARTY_HUB ptyH ON ptyH.PARTY_CODE = csl.PARTY_CODE
JOIN PTY_IMPL.PARTY_INFO_SAT ptyS ON ptyS.PARTY_INFO_HKEY = ptyH.PARTY_HKEY
JOIN PAS_IMPL.CUMULATION_DOCUMENTS_SAT_LATEST cdsl ON cdsl.CUMULATION_DOCUMENTS_HKEY = ch.CUMULATION_HKEY AND cdsl.RISK_GROUP_CODE = csl.RISK_GROUP_CODE AND csl.PARTY_CODE = cdsl.PARTY_CODE
JOIN PAS.CONTRACT c ON c.CONTRACT_NUMBER = cdsl.DOCUMENT_NUMBER
JOIN CFX.PUBLISHED_ARTIFACT pa ON pa.PUBLISHED_ARTIFACT_ID = c.PUBLISHED_ARTIFACT_ID
JOIN CFG.PROCESS_STATE ps ON ps.PROCESS_STATE_ID = c.STATE_ID
JOIN PAS_IMPL.CUMULATION_RISKS_SAT_LATEST crsl ON crsl.RISK_GROUP_CODE = csl.RISK_GROUP_CODE AND crsl.DOCUMENT_NUMBER = cdsl.DOCUMENT_NUMBER AND cdsl.CUMULATION_DOCUMENTS_HKEY = crsl.CUMULATION_RISKS_HKEY AND csl.PARTY_CODE = crsl.PARTY_CODE
JOIN PAS_IMPL.CUMULATION_RISK_GROUP crg ON crg.CODE = csl.RISK_GROUP_CODE
JOIN PAS_IMPL.CUMULATION_TRIGGER ct ON ct.CODE = csl.TRIGGER_CODE
JOIN BFX_IMPL.RISKS r ON r.CODE = crsl.RISK_CODE
JOIN PAS_IMPL.CUMULATION cu ON cu.ID = csl.CUMULATION_RULE_ID
JOIN PAS_IMPL.CUMULATION_LIMIT_AMOUNT cla ON cla.CODE = cu.LIMIT_AMOUNT_CODE
WHERE ch.CUMULATION_NUMBER = @cumulationQuoteNumber AND csl.PARTY_CODE = @partyCode
ORDER BY RISK_GROUP_CODE