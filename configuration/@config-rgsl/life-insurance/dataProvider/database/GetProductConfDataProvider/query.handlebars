SELECT
	 uvd.UNIVERSAL_VERSIONED_DOCUMENT_NUMBER
	,pConfSatL.PRODUCT_CODE
	,ps.CODE_NAME STATE_CODE_NAME
	,pa.CODE_NAME CONF_CODE_NAME
FROM BFX.UNIVERSAL_VERSIONED_DOCUMENT uvd
JOIN UNIV_IMPL.PRODUCT_CONF_HUB pConfHub ON pConfHub.PRODUCT_CONF_NUMBER = uvd.UNIVERSAL_VERSIONED_DOCUMENT_NUMBER
JOIN UNIV_IMPL.PRODUCT_CONF_SAT_LATEST pConfSatL ON pConfSatL.PRODUCT_CONF_HKEY = pConfHub.PRODUCT_CONF_HKEY
JOIN CFG.PROCESS_STATE ps ON ps.PROCESS_STATE_ID = uvd.STATE_ID
JOIN CFX.PUBLISHED_ARTIFACT pa ON pa.PUBLISHED_ARTIFACT_ID = uvd.PUBLISHED_ARTIFACT_ID
WHERE 1 = 1
{{#if parameters.documentNumber}}
	AND uvd.UNIVERSAL_VERSIONED_DOCUMENT_NUMBER = @documentNumber
{{/if}}
{{#if parameters.productCode}}
	AND pConfSatL.PRODUCT_CODE = @productCode
{{/if}}
{{#if parameters.excludeStates}}
	AND ps.CODE_NAME NOT IN (@excludeStates)
{{/if}}
