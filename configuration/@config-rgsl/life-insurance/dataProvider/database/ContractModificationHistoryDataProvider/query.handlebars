SELECT hist.MODIFICATION_TYPE,
	   hist.CONTRACT_NUMBER,
	   hist.CONFIGURATION_NAME,
	   hist.ORIGINAL_CONTRACT_NUMBER,
	   appU.USERNAME AS EXECUTED_BY_USER,
	   uclaim.VALUE AS EXECUTED_BY_PARTY,
	   hist.EXECUTED_ON
FROM BFX_IMPL.CONTRACT_MODIFICATION_HISTORY hist
JOIN ORG.APPLICATION_USER appU ON appU.APPLICATION_USER_ID = hist.EXECUTED_BY
JOIN ORG.APPLICATION_USER_CLAIM uclaim ON uclaim.APPLICATION_USER_ID = hist.EXECUTED_BY AND uclaim.CLAIM_TYPE = 'DisplayName'
WHERE 1 = 1
{{#if parameters.contractNumber}}
AND CONTRACT_NUMBER = @contractNumber
{{/if}}