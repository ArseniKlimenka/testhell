SELECT 
	invA.INV_PROFIT_ROW_ID,
	invA.IMPORT_DOCUMENT_ID,
	invA.CONTRACT_NUMBER,
	invA.INV_PROFIT_CALC_DATE,
	invA.INV_PROFIT_RATE,
	invA.INV_PROFIT_PAY_TYPE_CODE,
	invA.LOAD_DATE,
	pt.PAYMENT_TYPE_DESCRIPTION,
	ISNULL(alc.IS_CANCELLED, 1) AS IS_CANCELLED,
	ISNULL(alc.IS_PAID, 0) AS IS_PAID
FROM PAS_IMPL.INVESTMENT_PROFIT invA
LEFT JOIN PAS_IMPL.PAYMENT_TYPE pt ON pt.PAYMENT_TYPE_CODE = invA.INV_PROFIT_PAY_TYPE_CODE
LEFT JOIN PAS_IMPL.INVEST_PROFIT_ALLOCATION alc ON alc.INV_PROFIT_ROW_ID = invA.INV_PROFIT_ROW_ID AND ISNULL(alc.IS_CANCELLED, 1) = 0
WHERE 1 = 1
{{#if parameters.importDocumentId}}
AND IMPORT_DOCUMENT_ID = @importDocumentId
{{/if}}
{{#if parameters.contractNumber}}
AND CONTRACT_NUMBER = @contractNumber
{{/if}}