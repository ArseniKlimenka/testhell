# Инструменты стратегий в БД

## Импорт через загрузку Excel файла strategyInstruments.xlsx
- Документ импорта находиться в основном меню, во вкладке "Конфигурация -> Стратегии (инструменты)".
![Импорт инструментов стратегий](images\productConfiguration\strategyInstrumentsImport.png "Импорт инструментов стратегий")

### 1 шаг. Выбор файла.
- Выбрать файл для загрузки (ранее находился по пути) configuration\@config-rgsl\integration-tests\test\api\scenarios\InitialData\strategyInstruments.xlsx.
- Нажать на кнопку "Сохранить"(правый нижний угол) для передачи на сервер и присвоению номера для документа загрузки.
- Нажать на выбор "Действия"(правый верхний угол) и выбрать "Начать загрузку" для начало импорта данных. Подтвердить действие в выпавшем  диалоговом окне.

### 2 шаг. Загруженная Информация.
- После успешного импорта файла, появляется вкладка "Загруженная информация". В поле "Загруженные данные" отражаются строки успешно прошедшие валидацию на заполненность. В поле "Ошибки по загруженной информации" отражаются строки не прошедшие валидацию. Данные строки нужно скорректировать в соответствии с сообщением об ошибке в файле strategyInstruments.xlsx и загрузить корректный файл заново.

- Иногда если файл слишком большой процесс загрузки может остановиться на статусе "Загружаю" требуется в ручную обновить страницу(F5), до получения статуса "Загружено", для отображения результата и выбора дальнейшего действия.

### 3 шаг. Загруженные данные.
- Импорт данных в БД начнётся автоматически, если ошибок валидации в загружаемом файле не будет найдено.
- После того как был запущен процесс импорта появляется вкладка "Загруженные данные". До получения документом статуса "Импортировано" в нем будут отражаться статусы выполненных загрузок строк на данный момент времени. В случае зависания сервиса на сервере статус "Импортировано" не присваевается.
- Все успешные загрузки отражаются в поле "Импортированные данные".
- Все неуспешные загрузки отражаются в поле "Ошибка импорта".

## Наименование таблицы в БД.
- BFX_IMPL.STRATEGY_INSTRUMENTS

## Роли обладающие правами на загрузку.
- Administrator
- StrategyInstrImportSpecialist

## Создание договора через сервис
- В body должен быть объект basicInvestmentParameters, в enrichFields вызвать энричмент /basicInvestmentParameters[GetStrategyInstruments] или для вызова всех энричментов /basicInvestmentParameters.

> "basicInvestmentParameters": {},
> "enrichFields": [
>   "/basicInvestmentParameters[GetStrategyInstruments]"
> ]
