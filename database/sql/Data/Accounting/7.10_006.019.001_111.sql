
update acc_impl.SAP_GL_ACCOUNT_RULE set PREVIOUS_PERIOD = 0 where PREVIOUS_PERIOD is null
	and SAP_GL_ACCOUNT_ID = (select SAP_GL_ACCOUNT_ID from ACC_IMPL.SAP_GL_ACCOUNT where SAP_GL_ACCOUNT_NO = '3110002010')
	and OFR_ID = (select OFR_ID from ACC_IMPL.CT_OFR where OFR_CODE = '22109')
	and GL_ACCOUNT_ID = (select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '71404')
;

update acc_impl.SAP_GL_ACCOUNT_RULE set PREVIOUS_PERIOD = 1 where PREVIOUS_PERIOD is null
	and SAP_GL_ACCOUNT_ID = (select SAP_GL_ACCOUNT_ID from ACC_IMPL.SAP_GL_ACCOUNT where SAP_GL_ACCOUNT_NO = '3110002320')
	and OFR_ID = (select OFR_ID from ACC_IMPL.CT_OFR where OFR_CODE = '22109')
	and GL_ACCOUNT_ID = (select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '71404')
;

INSERT INTO ACC.CT_JOURNAL_TYPE (JOURNAL_TYPE_ID, DESCRIPTION, JOURNAL_CATEGORY_ID, ENTRY_TYPE_ID) VALUES (1001, 'Payment order', 3, null);

INSERT INTO acc.CT_DOCUMENT_TYPE (DOCUMENT_TYPE_ID, DESCRIPTION, ACCOUNT_TYPE_ID, PAYABLE) values (1017,'PaymentOrder - Invest profit',NULL,NULL);

--delete from ACC.CT_GL_POSTING_SCHEME where POSTING_SCHEME_ID in (69, 70);
INSERT INTO ACC.CT_GL_POSTING_SCHEME(POSTING_SCHEME_ID, SCHEME_NAME, SCHEME_TYPE_ID, JOURNAL_TYPE_ID, VALUE_SIGN, BA_ACCOUNT_TYPE_ID, INTERNAL, SOURCE_DOC_TYPE_ID, OPENED_BY_ENTRY_TYPE_ID, VALIDITY_START, VALIDITY_END, EXPLICIT, ITEM_TYPE_ID)
VALUES
(69, 'Payment order (Policy cancellation)', 1, 1001, null, null, 0, 1008, null, '19000101', '9999-12-31', 0, null),
(70, 'Payment order (Invest profit)', 1, 1001, null, null, 0, 1017, null, '19000101', '9999-12-31', 0, null)
;

--delete from ACC.GL_POSTING_SCHEME where POSTING_SCHEME_ID in (69, 70);
INSERT INTO ACC.GL_POSTING_SCHEME(POSTING_SCHEME_ID, SEQ_NUMBER, IS_DEBIT, GL_ACCOUNT_TYPE_ID, SIGN, VALUE_FIELD_ID, NET_VALUE_FIELD_ID, PAIR_NO, PAIR_SEQ_NO)
VALUES
(69, 1, 1, 1007, 1, 4, 4, 1, 1),
(69, 2, 0, 1006, 1, 4, 4, 1, 2),
(70, 1, 1, 1007, 1, 4, 4, 1, 1),
(70, 2, 0, 1006, 1, 4, 4, 1, 2)
;

update ACC.CT_GL_POSTING_SCHEME set JOURNAL_TYPE_ID = 1001 where POSTING_SCHEME_ID = 57;

insert into ACC_IMPL.CT_OFR (OFR_ID, OFR_CODE, DESCRIPTION) values (31,  '23105', '23105');

insert into ACC_IMPL.OFR_RULE (GL_ACCOUNT_ID, PREVIOUS_PERIOD, DOCUMENT_TYPE_ID, OFR_ID)
values
((select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '71406'), 1008, null, (select OFR_ID from ACC_IMPL.CT_OFR where OFR_CODE = '23103')),
((select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '71406'), 1017, null, (select OFR_ID from ACC_IMPL.CT_OFR where OFR_CODE = '23105'));

-- update account description
update acc.GL_ACCOUNT set description = 'Выплаты по страхованию жизни – неттоперестрахование' where GL_ACCOUNT_NO = '71406';
update acc.GL_ACCOUNT set description = 'Незавершенные расчеты по операциям страхования и перестрахования' where GL_ACCOUNT_NO = '48028';

-- TRANSACTION DEFINITION
INSERT INTO ACC_IMPL.TRANSACTION_DEFINITION (TRANSACTION_DEFINITION_NO, GL_ACCOUNT_ID_DT, OFR_ID_DT, GL_ACCOUNT_ID_CT, OFR_ID_CT, DOCUMENT_TYPE_ID, BELEGTC, BELEGSC_ALGL_2, BELEGSC_ALGL_3, BUCHUGC, VORGAST_ALGL_2, VORGAST_ALGL_3)
VALUES
('6.1.1', (select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '71406'),	(select OFR_ID from ACC_IMPL.CT_OFR where OFR_CODE = '23103'), (select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '48028'), null, null, '09', '09108', '09108', '10', '32', '32'),
('6.2.1', (select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '71406'),	(select OFR_ID from ACC_IMPL.CT_OFR where OFR_CODE = '23105'), (select GL_ACCOUNT_ID from acc.GL_ACCOUNT where GL_ACCOUNT_NO = '48028'), null, null, '09', '09108', '09108', '10', '32', '32');

-- SAP GL ACCOUNT
insert into ACC_IMPL.SAP_GL_ACCOUNT (SAP_GL_ACCOUNT_NO, DESCRIPTION, ATTRIBUTE_SET_ID)
values ('3120402060', '3120402060', 5);

insert into ACC_IMPL.SAP_GL_ACCOUNT_RULE (GL_ACCOUNT_ID, OFR_ID, PREVIOUS_PERIOD, PERSON_TYPE_ID, SAP_GL_ACCOUNT_ID)
values ((select GL_ACCOUNT_ID from ACC.GL_ACCOUNT where GL_ACCOUNT_NO = '71406'), (select OFR_ID from ACC_IMPL.CT_OFR where OFR_CODE = '23105'), null, null, (select SAP_GL_ACCOUNT_ID from ACC_IMPL.SAP_GL_ACCOUNT where SAP_GL_ACCOUNT_NO = '3120402060'));
