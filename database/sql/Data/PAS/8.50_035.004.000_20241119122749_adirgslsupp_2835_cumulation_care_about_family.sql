-- "Забота о будущем Ультра", "Забота о будущем", "Забота о семье", "Забота о семье Ультра"

-- 1.2. Связь группы продуктов с кодами продуктов
INSERT INTO PAS_IMPL.CUMULATION_PRODUCT_GROUP_RELATION (ID, PRODUCT_GROUP_CODE, PRODUCT_CODE)
VALUES
(N'DC275055-4DEF-4725-8C96-E67120B9EDAB', 'RISK_ACCUMULATION_DNS', N'ECOFPVTB'),
(N'2B93C00D-A9A7-4E82-BEF2-8188695AA969', 'RISK_ACCUMULATION_DNS', N'ECOFVVTB')

-- 2.1. Описание группы рисков
INSERT INTO PAS_IMPL.CUMULATION_RISK_GROUP(CODE, CODE_DESCRIPTION)
VALUES
(N'CDPAYW', N'Критические заболевания (выплата)+КЗ ОУСВ'),
(N'TDA', N'ВНТ НС')

-- 2.2. Связь группы рисков с кодами рисков
INSERT INTO PAS_IMPL.CUMULATION_RISK_GROUP_RELATION(ID, GROUP_CODE, RISK_CODE)
VALUES
-- Критические заболевания (выплата)+КЗ ОУСВ
(N'73E9457F-0400-493D-87F1-A5B146D5C34C', 'CDPAYW', N'CD636404'),
(N'987C1325-60E1-42E1-858E-A6896281D7DE', 'CDPAYW', N'CD5C36404'),
(N'D86F16F9-4D47-4A6C-BB44-DB6CA38F465E', 'CDPAYW', N'CDP36102'),
(N'47DF9B48-D93E-41DA-A7D6-DCC29798258E', 'CDPAYW', N'CD36404'),
(N'4098B03D-9530-4294-861B-0BDB59036823', 'CDPAYW', N'CDP36404'),
(N'92119EE2-9626-4687-9D1D-8257DCC26424', 'CDPAYW', N'CDVV36404'),
(N'E20DD387-7933-4A7D-8243-E163B6274842', 'CDPAYW', N'CD1120700'),
(N'56EADDB2-199C-4BCC-9714-AF30BEFFE179', 'CDPAYW', N'CD620700'),
(N'AC1C57A2-EFC5-4587-9658-BBFD4A945A4B', 'CDPAYW', N'CD10C36102'),
(N'C87D529A-A90D-4E86-9E2C-769ACDF04CCF', 'CDPAYW', N'M5CD36102'),
(N'95A1D045-4E0A-44E0-8FA0-974495DB59A4', 'CDPAYW', N'CD5C36102'),
(N'F4BA4106-9D6E-41EF-BC7B-C0879395E3E7', 'CDPAYW', N'CD6W36102'),
(N'67E13522-10E9-411C-A8F8-25584797AFDF', 'CDPAYW', N'M6CD36102'),
(N'5EF0D8E6-6D10-40DA-8530-E6FADBF02117', 'CDPAYW', N'CD1136102'),
(N'B5669648-78D0-4736-9E76-E1025372B508', 'CDPAYW', N'M11CDW33102'),
(N'7D6ED76D-8221-45F7-9773-CC0387F5F304', 'CDPAYW', N'M6CD33102'),
(N'9526865B-E6F2-482B-91FA-B8342B308B9F', 'CDPAYW', N'M11CD33102'),
(N'0AA9D936-8D0B-43E4-B8EC-B209DF96F6A2', 'CDPAYW', N'CD136102'),
(N'22BB322D-7B45-4D2F-B93B-3489D3F5B6D4', 'CDPAYW', N'CDCII36102'),
(N'6D8D97EC-1267-4D72-90D1-DA53BA1D65A5', 'CDPAYW', N'CD3W36102'),
(N'CF87B659-CAB7-4B0E-8C7C-F14110EA69E5', 'CDPAYW', N'CD4C36102'),
-- ВНТ НС
(N'6E6F32D2-89BB-447D-A403-3456ADB7D6F5', 'TDA', N'CTDA36404'),
(N'4F95664E-C355-41DC-BFA4-F77BE1CC55DE', 'TDA', N'TDA20700'),
(N'E7BA5508-016D-4495-A1EC-7E02FECADE97', 'TDA', N'TDA36102'),
(N'54FC0382-15BA-41E2-9956-C4B4A2C85490', 'TDA', N'TDA33302'),
(N'62D2DE6D-1512-4063-A39F-10918BF33699', 'TDA', N'TDA33102'),
(N'486D3643-81DA-46C3-AE9E-16CB91D1BC85', 'TDA', N'TDLP20700')

-- 3.2. Лимиты по страховой сумме
INSERT INTO PAS_IMPL.CUMULATION_LIMIT_AMOUNT (CODE, AMOUNT_FROM, AMOUNT_TO, AMOUNT_DESCRIPTION)
VALUES
(N'LESS_6000000', NULL, 6000000, N'≤ 6 000 000'),
(N'MORE_6000001', 6000001, NULL, N'≥ 6 000 001'),
(N'LESS_1200000', NULL, 1200000, N'≤ 1 200 000'),
(N'MORE_1200001', 1200001, NULL, N'≥ 1 200 001')

-- 5. Кумуляция
INSERT INTO PAS_IMPL.CUMULATION(ID, PRODUCT_GROUP_CODE, PRODUCT_CODE, RISK_GROUP_CODE, LIMIT_AGE_CODE, LIMIT_AMOUNT_CODE, TRIGGER_CODE, ACTIVE_PERIOD_CODE)
VALUES
-- ECOFPVTB (Забота о семье)
('3180DFC8-4E3A-4396-9DA6-C1F1FC8A8157', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DLPW', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('4DBDB3C0-F21D-406A-844D-493A600E52FF', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DLPW', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('E2202F3F-21EA-4792-8E47-05060C13FADA', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DLPWNSTPDTP', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('7824919A-4AFD-48C4-A5CF-012A0410E9AE', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DLPWNSTPDTP', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequiredFinancialDocuments', 'ETERNITY'),

('B5160CB4-5D0A-4B4C-B8E9-00161AE7B60A', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DNSVV', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('BD50E91A-2EC2-4425-9670-F2260C1A9B03', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DNSVV', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('BD5D3BAC-984C-487B-97FB-4A4A27796005', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'TPDTP', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('D62B2BE4-26F3-436A-8039-793011C547F4', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'TPDTP', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('652D9975-9F56-43F4-8411-F8339B64B1FC', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DI', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('2701B86E-6722-49E9-859A-C7C69F6F00A1', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'DI', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('2B732F10-710F-4018-ACC1-4D3415809FC8', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'CDPAYW', N'DONT_CHECK', N'LESS_6000000', N'ApprovalNotRequired', 'ETERNITY'),
('78E92752-C29C-4E88-A030-DE4DF7A915F2', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'CDPAYW', N'DONT_CHECK', N'MORE_6000001', N'UWApprovalRequired', 'ETERNITY'),

('A7F467E9-920B-4BF5-8310-68650DA41FC4', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'TDA', N'DONT_CHECK', N'LESS_1200000', N'ApprovalNotRequired', 'ETERNITY'),
('8184EB51-1CCC-4388-BA82-6E8F03CC0D11', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'TDA', N'DONT_CHECK', N'MORE_1200001', N'UWApprovalRequired', 'ETERNITY'),

('060D6E02-18C6-4E90-B000-61D3683039E6', N'RISK_ACCUMULATION_DNS', N'ECOFPVTB', N'CDH', N'DONT_CHECK', N'DONT_CHECK', N'RiskCantBeApplied', 'ETERNITY'),

-- ECOFVVTB (Забота о семье Ультра)
('8112B593-6539-4584-8D9F-15C8C9E08900', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DLPW', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('063A33AD-135B-426C-908F-D26D665AF3B7', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DLPW', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('C02EE48D-9C4E-4788-92AE-DACE16E72E77', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DLPWNSTPDTP', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('ED7DDBA8-669A-4073-9A5B-2534D7536A2F', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DLPWNSTPDTP', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequiredFinancialDocuments', 'ETERNITY'),

('5E32BFB6-0A6E-47B4-85B4-3DCDAC88F190', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DNSVV', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('566E3B41-454C-44DD-94A4-D7969A7712F4', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DNSVV', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('1F751D8E-3004-4A64-89B6-DD6F98EE6DB5', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'TPDTP', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('80DCFCC8-F1DF-42FA-B8BB-15F7AB2E3D97', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'TPDTP', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('04D5D21E-C09F-47B8-8781-C108BD676634', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DI', N'DONT_CHECK', N'LESS_10500000', N'ApprovalNotRequired', 'ETERNITY'),
('648A6E02-3EBF-46F4-AE90-C60F2B31086F', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'DI', N'DONT_CHECK', N'MORE_10500001', N'UWApprovalRequired', 'ETERNITY'),

('7120B59E-0A7A-4BE7-88DF-E030AE72DD62', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'CDPAYW', N'DONT_CHECK', N'LESS_6000000', N'ApprovalNotRequired', 'ETERNITY'),
('B12A020F-B0AA-4C84-8FCA-33283BB81F28', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'CDPAYW', N'DONT_CHECK', N'MORE_6000001', N'UWApprovalRequired', 'ETERNITY'),

('CCBD0B16-2A74-4CE8-8933-EBC2A8651889', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'TDA', N'DONT_CHECK', N'LESS_1200000', N'ApprovalNotRequired', 'ETERNITY'),
('2F2E2912-1FD0-482D-8A8D-0E9705AC9C78', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'TDA', N'DONT_CHECK', N'MORE_1200001', N'UWApprovalRequired', 'ETERNITY'),

('FE3589A2-F0A6-4104-9E06-654AB9B43DBD', N'RISK_ACCUMULATION_DNS', N'ECOFVVTB', N'CDH', N'DONT_CHECK', N'DONT_CHECK', N'RiskCantBeApplied', 'ETERNITY')

-- Новый алгоритм расчёта в зависимости от payment_form
UPDATE PAS_IMPL.CUMULATION_RISK_GROUP
SET MAX_RISK_COUNT = 1,
	MRC_ALGORITHM = 'PAYMENT_FORM',
	MRC_ALGORITHM_PRODUCT_CODES = '["ECOFPVTB","ECOFVVTB"]'
WHERE CODE = 'DI'

UPDATE PAS_IMPL.CUMULATION_RISK_GROUP
SET MRC_ALGORITHM = 'MAX_RISK_COUNT'
WHERE CODE = 'CDH'